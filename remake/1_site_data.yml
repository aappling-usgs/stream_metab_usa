target_default: 1_site_data

packages:
  - yaml
  - dplyr
  - dataRetrieval
  - mda.streams
  
sources:
  - ../1_site_data/code/init_site_list.R
  - ../1_site_data/code/get_nwis_sites.R
  - ../lib/load_profile.R

targets:
  1_site_data:
    depends: 
      - sites
      - sb_metadata
  
  sites.config:
    command: yaml.load_file('../1_site_data/in/sites_config.yaml')
  
  sites:
    command: init_site_list(sites.config, '../1_site_data/out/site_list.txt')

  sb_sites:
    command: sb_post_sites(sites, sites.config)

  metadata:
    command: stage_meta_basic()
    depends: sb_sites
    
  sb_metadata: 
    command: post_meta(metadata)
